# GAP Tracker アプリケーション仕様書

## 1. 概要

GAP Tracker は、農業における適正農業規範（Good Agricultural Practices）に準拠した農業経営管理システムです。React と Firebase を使用して構築されており、農場の作業記録、資材管理、収穫・出荷管理を包括的に行うことができます。

## 2. システム構成

### 2.1 技術スタック

| 技術 | バージョン | 用途 |
|------|----------|------|
| React | ^18.2.0 | フロントエンドフレームワーク |
| Firebase | ^9.22.0 | バックエンドサービス（認証、データベース、ストレージ）|
| React Router DOM | ^6.11.2 | ルーティング |
| Tailwind CSS | ^3.3.2 | スタイリング |
| date-fns | ^2.30.0 | 日付処理 |
| react-hot-toast | ^2.5.2 | 通知表示 |

### 2.2 Firebase 設定

- **Authentication**: ユーザー認証
- **Firestore**: NoSQL データベース
- **Storage**: ファイル保存
- **Hosting**: ウェブアプリケーションホスティング

## 3. 機能仕様

### 3.1 認証機能

#### 3.1.1 ユーザー登録
- メールアドレス・パスワード認証
- ユーザープロフィール作成（名前、メールアドレス、役割）
- 自動ユーザープロフィール作成機能

#### 3.1.2 ログイン/ログアウト
- Firebase Authentication による認証
- 認証状態の自動管理
- プライベートルートによるアクセス制御

### 3.2 ダッシュボード機能

#### 3.2.1 表示要素
- ユーザー情報表示
- システム状態表示
- 最新の作業日誌（5件）
- 最新の収穫記録（5件）
- 最新の出荷記録（5件）

#### 3.2.2 クイックアクセス
- 作業日誌登録
- 収穫記録登録
- 肥料使用記録
- 圃場点検記録

### 3.3 作業日誌管理

#### 3.3.1 基本情報
- 作業日付（必須）
- 圃場選択（必須）
- 作業種別（必須）
- 担当者（複数選択可）
- 作業内容詳細

#### 3.3.2 作業時間・収穫量
- 作業時間（時間単位）
- 収穫量・単位
- 廃棄量・単位

#### 3.3.3 専門作業記録
作業種別に応じて動的に表示：

**施肥作業**
- 使用肥料選択
- 使用量・単位
- 施肥方法（散布、液肥、土壌改良剤、その他）

**播種・定植作業**
- 種子・苗選択
- 使用量・単位
- 播種方法（直播、移植、その他）

**病害虫防除作業**
- 使用農薬選択
- 対象病害虫
- 希釈倍率
- 散布方法（噴霧、散粉、土壌処理、その他）
- 天候・気温・風速記録

### 3.4 圃場管理

#### 3.4.1 圃場基本情報
- 圃場名（必須）
- 所在地（必須）
- 面積（m²、必須）
- 土壌タイプ（必須）
  - 砂質土、粘土質、シルト質、壌土、火山灰土、赤土
- 備考

### 3.5 資材管理

#### 3.5.1 種子・苗管理
- 作物名・品種
- 供給業者・ロット番号
- 購入日
- 消毒方法
  - なし、温湯、次亜塩素酸ナトリウム、エタノール、その他、消毒済み
- 備考

#### 3.5.2 肥料管理
- 肥料名・製造元
- 種別・ロット番号
- 供給業者
- NPK成分（窒素・リン酸・カリウム含有率）
- 購入日・備考

#### 3.5.3 農薬管理
- 農薬名・製造元
- 種別・有効成分
- 有効成分濃度・剤型
- 農薬登録番号
- 購入日・有効期限
- 供給業者・ロット番号

### 3.6 収穫管理

#### 3.6.1 収穫記録
- 圃場選択
- 作物名
- 収穫日
- 収穫量・単位（kg、g、t、個、箱、袋）
- 品質等級（優、良、可）
- 備考

### 3.7 出荷管理

#### 3.7.1 出荷記録
- 出荷先
- 出荷日
- 作物名
- 出荷量・単位
- 配送方法
- 状態（準備中、出荷中、完了、キャンセル）
- ロット番号
- 収穫記録連携

### 3.8 その他管理機能

#### 3.8.1 訪問者管理
- 訪問者情報記録
- 訪問日時・目的記録

#### 3.8.2 教育・訓練記録
- 研修内容記録
- 受講者管理

## 4. データベース設計

### 4.1 コレクション構造

```
users/
├── {userId}/
    ├── name: string
    ├── email: string
    ├── role: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp

workLogs/
├── {documentId}/
    ├── userId: string
    ├── date: timestamp
    ├── fieldId: string
    ├── fieldName: string
    ├── workType: string
    ├── workerNames: array
    ├── description: string
    ├── workHours: number
    ├── harvestAmount: number
    ├── harvestUnit: string
    ├── wasteAmount: number
    ├── wasteUnit: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp

fields/
├── {documentId}/
    ├── userId: string
    ├── name: string
    ├── location: string
    ├── area: number
    ├── soilType: string
    ├── description: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp

seeds/
├── {documentId}/
    ├── userId: string
    ├── cropName: string
    ├── variety: string
    ├── supplier: string
    ├── lotNumber: string
    ├── purchaseDate: timestamp
    ├── disinfectionMethod: string
    ├── notes: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp

fertilizers/
├── {documentId}/
    ├── userId: string
    ├── name: string
    ├── manufacturer: string
    ├── type: string
    ├── lotNumber: string
    ├── supplier: string
    ├── nitrogen: number
    ├── phosphorus: number
    ├── potassium: number
    ├── purchaseDate: timestamp
    ├── notes: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp

pesticides/
├── {documentId}/
    ├── userId: string
    ├── name: string
    ├── manufacturer: string
    ├── type: string
    ├── activeIngredient: string
    ├── concentration: number
    ├── formulation: string
    ├── registrationNumber: string
    ├── purchaseDate: timestamp
    ├── expiryDate: timestamp
    ├── supplier: string
    ├── lotNumber: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp

harvests/
├── {documentId}/
    ├── userId: string
    ├── fieldId: string
    ├── fieldName: string
    ├── cropName: string
    ├── harvestDate: timestamp
    ├── quantity: number
    ├── unit: string
    ├── qualityGrade: string
    ├── notes: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp

shipments/
├── {documentId}/
    ├── userId: string
    ├── destination: string
    ├── shipmentDate: timestamp
    ├── cropName: string
    ├── quantity: number
    ├── unit: string
    ├── shippingMethod: string
    ├── status: string
    ├── lotNumber: string
    ├── harvestId: string
    ├── notes: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp

visitors/
├── {documentId}/
    ├── userId: string
    ├── name: string
    ├── organization: string
    ├── visitDate: timestamp
    ├── purpose: string
    ├── notes: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp

trainings/
├── {documentId}/
    ├── userId: string
    ├── title: string
    ├── description: string
    ├── trainingDate: timestamp
    ├── instructor: string
    ├── participants: array
    ├── duration: number
    ├── materials: string
    ├── notes: string
    ├── createdAt: timestamp
    └── updatedAt: timestamp
```

## 5. ユーザーインターフェース

### 5.1 レスポンシブデザイン
- Tailwind CSS によるモバイルファースト設計
- タブレット・デスクトップ対応
- タッチ操作対応

### 5.2 ナビゲーション
- サイドバーメニュー
- ブレッドクラム表示
- クイックアクションボタン

### 5.3 フォーム設計
- 入力検証機能
- 自動保存機能
- 関連データの自動連携

## 6. セキュリティ

### 6.1 認証・認可
- Firebase Authentication
- ユーザー別データ分離
- プライベートルート保護

### 6.2 データ保護
- Firebase Security Rules
- HTTPS 通信
- 入力データサニタイズ

## 7. 性能・可用性

### 7.1 性能最適化
- 遅延読み込み
- データキャッシュ
- 最適化された画像配信

### 7.2 可用性
- Firebase の高可用性インフラ
- 自動バックアップ
- 障害時の自動回復

## 8. 運用・保守

### 8.1 デプロイメント
- Firebase Hosting
- 自動デプロイメント
- 段階的ロールアウト

### 8.2 監視・ログ
- Firebase Analytics
- エラー追跡
- 使用状況監視

## 9. 今後の拡張性

### 9.1 予定機能
- レポート機能
- データエクスポート
- 多言語対応
- モバイルアプリ

### 9.2 統合機能
- 気象データ連携
- 市場価格情報
- 認証機関連携

## 10. 制約事項

### 10.1 技術的制約
- Firebase の同時接続制限
- データ転送量制限
- ストレージ容量制限

### 10.2 機能制約
- 現在は単一農場対応
- オフライン機能未対応
- 大量データ処理制限

---

**文書バージョン**: 1.0  
**最終更新日**: 2025年7月5日  
**作成者**: Claude Code Analysis